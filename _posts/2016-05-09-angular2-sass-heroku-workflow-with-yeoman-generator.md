---
layout: post
title: "Angular2: Code-Test-Deploy-Repeat"
description: "Create Angular2 application using Yeoman and deploy it on Heroku"
date: 2016-05-09 19:42:03 +0530
author: "Tushar Chauhan"
comments: true
disqus_identifier: "T6K4S5h0P5M2"
---

While [**Angular**](https://angularjs.org/) has been a strictly opinionated framework of JavaScript, it has always been quite un-opinionated about how you structure your application and how you deploy it. Being un-opinionated about the project structure and deployment strategy is both good and bad. Good, because it let's you decide how you arrange(_MVC or based on features_) your code and where to deploy. Bad, because it becomes quite confusing for beginners to decide one of many ways to structure and deploy angular applications.

With [**Angular2**](https://angular.io/) on it's way to deliver the first stable build in [some time](https://github.com/angular/angular/milestones), developers have already started trying out the beta versions to get used to it. Also, [TypeScript](http://www.typescriptlang.org) is being considered as the recommended language for Angular2, thereby adding one extra step(compilation) in the development process.

I have checked out [Angular2 quickstart project](https://github.com/angular/quickstart) & [angular-cli](https://github.com/angular/angular-cli). Although the boilerplate is quite self sufficient, it still lacks the same stuff which Angular did: structure and deployment. Playing around with the quickstart project was good, but I wanted to checkout the complete flow of developing, testing and deploying an Angular2 app and making the process as easy as possible till we have a stable build of Angular2 and some official guidance from it's creators.

I have created a **[Yeoman Generator](https://www.npmjs.com/package/generator-angular2-sass-gulp-heroku)**, which creates the boilerplate for a simple Angular2 app. This structure is similar to what is generated by angular-cli. The resulting application uses all the commands provided by the cli along with few tweaks which have been added to include SASS and Bootstrap SASS.

Moreover, I have added steps to deploy the generated application on [Heroku](https://www.heroku.com) without any extra dependencies, just using the modules which are already in the project.

Below, I will explain how to use this generator to get a fully working Angular2 startup app with:

* A folder structure to arrange your TypeScript code neatly
* Gulp tasks to clean and move static font files within build.
* [SASS](http://sass-lang.com/)(SCSS syntax) & [Bootstrap SASS](https://github.com/twbs/bootstrap-sass) support(Javascript library of Bootstrap included)
* Minor tweaks for Heroku deployment

### Prerequisites

* [Node.js](https://nodejs.org/) (version >= 4)
* Git installed on your development machine
* [Heroku](https://www.heroku.com) account & [Heroku Toolbelt](https://toolbelt.heroku.com) installed. Log in to Heroku using Heroku toolbelt on your terminal/CMD prompt.

### Install global dependencies

Run these commands to globally install [angular-cli](https://github.com/angular/angular-cli), [Yeoman](http://yeoman.io) & [the app generator](https://www.npmjs.com/package/generator-angular2-sass-gulp-heroku):

```sh
npm install -g angular-cli
npm install -g yo
npm install -g generator-angular2-sass-gulp-heroku
```

### Generate the project
I will be using _test-project_ as project name.

Run:

```sh
yo angular2-sass-gulp-heroku test-project
```

The generator will ask following details:

1. Project name
2. Small description of the project
3. Github URL(if any) of the project

Once you fill in these details, the project will be created in the directory where you executed the above command.

Change to the project directory now.

```sh
cd test-project
```
ðŸ”´ Hereafter, we will run all the commands within **test-project** directory

### Install npm packages

Install the npm packages described in the `package.json` and verify that it works:

**Attention Windows Developers:  You must run all of these commands in administrator mode**

```sh
npm install
```

### Running the application

To run the application locally, execute:

```sh
npm start
```
Shut it down manually with Ctrl-C.

### Structure for 'app' directory

<pre>
â”œâ”€â”€ <b>src</b>
â”‚Â Â  â”œâ”€â”€ <b>app</b>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <b>components</b>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <b>pipes</b>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <b>services</b>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <b>shared</b>
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ environment.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ site.component.html
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ site.component.scss
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ site.component.spec.ts
â”‚Â Â  â”‚Â Â  â””â”€â”€ site.component.ts
</pre>

Once you run `npm start`, a directory named `dist` will be created, which holds all the compiled files along with HTML and CSS.

'index.html' is the entry point of the application.

As per this structure, it will be easy if you:

* keep all components in the _'components'_ folder
* keep the templates and CSS/SCSS related to components in specific component folder
* keep all pipes in the _'pipes'_ folder
* keep all services in the _'services'_ folder

In this project 'site.component' is the first component to load, but you can change it.
To create new components, services, pipes etc in their respective directories, checkout the documentation of [angular-cli](https://github.com/angular/angular-cli).

_e.g._ for creating a header component in this project you can run:

```sh
ng g component components/header
```

This will create the new component in the components directory itself.

Moreover, you can create any other folders to hold TypeScript files within 'app' directory, the compilation will recursively compile and create appropriate structure in the 'dist' directory.

Bootstrap SASS is already included in the application using the 'styles/main.scss' file. If you like using SASS only, you can create further SCSS files within same directory or component specific directories. SASS compilation is already enabled in this app.

### Testing

**End-to-end (E2E) Tests:**

**BEFORE RUNNING THE FIRST TEST** you must update the Selenium webdriver. Run

```sh
npm run pree2e
```

You will also need to start your app using

```sh
npm start
```

E2E tests are usually at the project root, in the 'e2e' folder
Their filenames must end in `e2e.ts`.

Look for the example `e2e.ts` in the root folder.
Add more `e2e.ts` files as you wish (although one usually suffices for small projects);

Thereafter, in another terminal window/tab run them with:

```sh
ng e2e
```

**Unit Tests:**

To initiate karma test runner, run:

```sh
ng test
```

### Deploying on Heroku
You must have a Heroku account to create an app on Heroku.

You also need to install & Log into [Heroku Toolbelt](https://toolbelt.heroku.com/) in your local machine

Following are the steps for Heroku deployment(If you haven't created a Heroku app from  Dashboard & also haven't initiated git locally):

1. Initiate GIT in your project using `git init`
2. Create a Heroku App using `heroku create` from the root of the project.
3. Once created, verify the remote in your git configuration using `git remote -v`
4. Deploy using `git push heroku master`

Following are the steps for Heroku deployment(If you have created the Heroku app from Dashboard & have already initiated git in your local project):

1. Run `heroku git:remote -a [YOUR-APP-NAME]`, to add heroku remote in your git configuration.
2. Deploy using `git push heroku master`

### Finally

This is just an attempt to make Angular2 app development easy to try it out live on Heroku.

In some time we will see some official direction/guidance from the developers of Angular2 regarding project structure and deployment, as they are actively working on [angular-cli](https://github.com/angular/angular-cli) following the success of [ember-cli](http://ember-cli.com).

I hope people try this workflow out. Please let me know if something doesn't workout for you.
